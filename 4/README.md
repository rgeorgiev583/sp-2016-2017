# `dup(2)`

Това системно извикване се използва за създаване на копие на файлов дескриптор.


## Синтаксис

		#include <unistd.h>

        int dup(int fd);
        int dup2(int fd, int newfd);


## Семантика

Функцията `dup` се използва за създаване на файлов дескриптор, който може да се използва за достъп до същия отворен файл както подадения като аргумент файлов дескриптор.
Тя връща номера на новия дескриптор, за който е гарантирано, че е най-малкото положително число, което не се използва за номер от друг файлов дескриптор.
Функцията `dup2` работи по сходен начин, като позволява да се определи номера на новия файлов дескриптор чрез аргумента `newfd`.  Ако до момента на извикването ѝ не е съществувал файлов дескриптор с този номер, той ще бъде създаден и самият номер ще бъде върнат.  Ако вече съществува такъв, поведението на функцията ще е като на `dup` (т.е. ще избере най-малкият незает номер).
През новосъздадения файлов дескриптор достъпът се случва по абсолютно същия начин, както през стария.  Състоянието на отворения файл (т.е. *описанието на отворения файл*) се споделя от двата дескриптора (като пример промяната на файловия офсет през единия дескриптор ще е видима и през другия дескриптор).
Файлът се затваря (т.е. описанието му се затваря), когато се затвори последният файлов дескриптор, свързан с него.

## Употреба

### Пренасочване на стандартен вход и изход

При затваряне на стандартния вход/изход и последващо отваряне на нов файл за четене/писане, за него ще бъде заделен файловият дескриптор с най-малък номер (съгласно дефиницията на `open(2)`), като той ще е със същия номер като стандартния вход (`0`)/стандартния изход (`1`).  Ако файлът вече е отворен, същият ефект може да се получи, като се затвори стандартният вход/изход и след това се копира файловият дескриптор на отворения файл (логиката на номерата е същата като в предишния случай).
Смисълът от тези действия е програмата да се абстрахира от това с какъв вид отворени файлове работи (в общия случай за нея не трябва да има значение дали входът/изходът са конзола или обикновен файл, както и дали е `pipe`-нат изходът на друга програма към нея/дали нейният изход е `pipe`-нат към друга програма).  По този начин тя може да се ограничи до работа със стандартния вход и изход, които да бъдат пренасочвани при нужда.
Както се вижда в примерите, в зависимост от това по какъв начин са пренасочени стандартният вход или изход, един и същ фрагмент код ще се държи по напълно различен начин.


## Задачи

1. Изведете файл, подаден като аргумент на командния ред, използвайки пренасочване на стандартния вход.
2. Запишете подаденото на стандартния вход във файл, подаден като аргумент, използвайки пренасочване на стандартния изход.